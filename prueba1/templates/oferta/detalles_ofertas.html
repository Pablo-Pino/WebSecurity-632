{% extends "master_page/master_page.html" %}

{% block title %}Detalles de ofertas{% endblock %}

{% block body %}

    <div>

        <h3>Identificador : {{ oferta.identificador }}</h3>

        {% if oferta.cerrada %}
            <h4 style="color:red;">CERRADA</h4>
        {% endif %}

        {% if oferta.vetada %}
            <h4 style="color:red;">VETADA</h4>
        {% endif %}

        <p>Titulo : {{ oferta.titulo }}</p>
        <p>Descripcion : {{ oferta.descripcion }}</p>
        <p>Fecha de creacion : {{ oferta.fecha_creacion }}</p>
        <p>Autor : {{ oferta.autor.django_user.first_name }} {{ oferta.autor.django_user.last_name }} </p>
        {% if oferta.vetada %}
            <p>Motivo de veto : {{ oferta.motivo_veto }}</p>
        {% endif %}

        <br>

        <fieldset><legend>Actividades</legend>
            <br>
            {% for actividad in actividades %}
                <fieldset>
                    <p>{{ actividad.identificador }}</p>
                    <p>{{ actividad.titulo }}</p>
                    <p><a href="/actividad/detalles/{{actividad.id}}/">Detalles de la actividad</a></p>
                </fieldset>
                <br>
            {% endfor %}

        </fieldset>

    </div>

    {% if oferta.borrador and oferta.autor == usuario and not oferta.vetada and not oferta.cerrada %}
        <td>
            <button id="button_editar" onclick="window.location.href = '/oferta/edicion/{{ oferta.id }}/'">Editar oferta</button>
        </td>
        <td>
            <button id="button_eliminar" onclick="alerta_redireccion('Desea eliminar esta oferta ?', '/oferta/eliminacion/{{ oferta.id }}/')">Eliminar oferta</button>
        </td>
    {% endif %}
    {% if not oferta.borrador and oferta.autor == usuario and not oferta.vetada and not oferta.cerrada %}
        <td>
            <button id="button_cerrar" onclick="alerta_redireccion('Desea cerrar esta oferta ?', '/oferta/cierre/{{ oferta.id }}/')">Cerrar oferta</button>
        </td>
    {% endif %}
    {% if not oferta.borrador and usuario.es_admin and not oferta.cerrada %}
        {% if oferta.vetada %}
            <td>
                <button id="button_levantar_veto" onclick="alerta_redireccion('Desea levantar el veto sobre est oferta ?', '/oferta/levantamiento_veto/{{ oferta.id }}/')">Levantar el veto sobre la oferta</button>
            </td>
        {% else %}
            <td>
                <button id="button_vetar" onclick="window.location.href = '/oferta/veto/{{ oferta.id }}/'">Vetar oferta</button>
            </td>
        {% endif %}
    {% endif %}

{% endblock %}